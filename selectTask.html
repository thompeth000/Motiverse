<!DOCTYPE html>

<html>
  <head>
  <style>
  #signup{
    margin: auto;
}


  .text{
    color: white;
    font-family: Helvetica;
    background-color: #03c03c;
    text-decoration: none;
}

#submit{
    background-color: #53d179;
	border-color: #53d179;
    width: 100px;
    height: 30px;
    font-size: 20px;
    text-align: center;
	margin: auto;
	
}

body{
    background-color: #03c03c;
}
  </style>
    <script src="/socket.io/socket.io.js"></script>
    <script>
	var socket = io();
	var tasks = new Array();
	function searchTasks(){
	  socket.emit('taskQuery', {'search': document.forms['taskSearch']['searchBox'].value});
	  socket.on('taskQueryRes', function(data){
	    refreshTaskList(data.tasks);
	  });
	 }
	 
	 function refreshTaskList(taskList){
	 document.write('<h1>Search Results</h1>');
	 if(taskList.length === 0){
	   document.write('<p>No tasks found...</p>');
	 }
	 else{
	   for(i = 0; i < taskList.length; i++){
	     console.log('Displaying task...');
	     renderList(taskList[i]);
	   }
	 }
	 document.write('<a href="/taskSelect">Back...</a>');
	}
	
	function requestTask(taskID){
	  socket.emit('addTask', {'task': taskID});
	  socket.on('feedback', function(data){
	    console.log(data.message);
	  });
	}
	</script>
  </head>
  <body>
    <h1 class="text">Select Task...</h1>
	  <a href="/dashboard">Back to Dashboard...</a>
	  <form id="taskSearch">
	    <input id="searchBox">
		<button id="submit" onclick="searchTasks()" class="text">Search</button>
	  </form>
	  <h3 class="text">Here, you can select and add any task you wish to complete to your account. You may only have four tasks active at a time, so choose wisely!</h3>
	  <script>
	    function renderList(task){
		document.write('<button class="taskButton" onclick="requestTask(' + task._id + ')">' + task.title + '</button>');
		document.write(task.val + ' pts');
		document.write('</br>');
		}
	  </script>
	
  </body>
</html>